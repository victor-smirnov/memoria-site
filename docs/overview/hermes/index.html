<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://memoria-framework.dev/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://memoria-framework.dev/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://memoria-framework.dev/fonts/KaTeX_Main-Regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://memoria-framework.dev/fonts/KaTeX_Math-Italic.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://memoria-framework.dev/main.43348b05ac9ca2e637541352cdabb0575c2997fca745167924a89160f68647ba31a7f6ca773ecfe6d9a0f96c363d860159c751a55c5ba3a07338a8b7ef71047a.css integrity="sha512-QzSLBaycouY3VBNSzauwV1wpl/ynRRZ5JKiRYPaGR7oxp/bKdz7P5tmg+Ww2PYYBWcdRpVxbo6BzOKi373EEeg==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Hermes - Memoria</title><meta name=description content><link rel=canonical href=https://memoria-framework.dev/docs/overview/hermes/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Hermes"><meta property="og:description" content="In ancient Greek mythology Hermes is a messenger between gods and humans.
 Basic information In the context of Memoria Framework, Hermes is a solution to the &ldquo;last mile&rdquo; data modelling problem. Containers can be used to model large amounts of highly structured data. Hermes is intended to represent relatively small amount of unstructured or semi-structured data and can be used together with containers. Notable feature of Hermes as a data format is that all objects and data types have canonical textual representation, so Hermes data can be consumed and produced by humans."><meta property="og:url" content="https://memoria-framework.dev/docs/overview/hermes/"><meta property="og:site_name" content="Memoria"><meta property="article:published_time" content="2020-10-06T08:48:57+00:00"><meta property="article:modified_time" content="2020-10-06T08:48:57+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:title content="Hermes"><meta name=twitter:description content><meta name=twitter:card content="summary"><meta name=twitter:image:alt content="Hermes"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://memoria-framework.dev/#/schema/person/1","name":"Memoria","url":"https://memoria-framework.dev/","sameAs":[],"image":{"@type":"ImageObject","@id":"https://memoria-framework.dev/#/schema/image/1","url":"https://memoria-framework.dev/\u003cnil\u003e","width":null,"height":null,"caption":"Memoria"}},{"@type":"WebSite","@id":"https://memoria-framework.dev/#/schema/website/1","url":"https://memoria-framework.dev/","name":"Memoria","description":"","publisher":{"@id":"https://memoria-framework.dev/#/schema/person/1"}},{"@type":"WebPage","@id":"https://memoria-framework.dev/docs/overview/hermes/","url":"https://memoria-framework.dev/docs/overview/hermes/","name":"Hermes","description":"","isPartOf":{"@id":"https://memoria-framework.dev/#/schema/website/1"},"about":{"@id":"https://memoria-framework.dev/#/schema/person/1"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","breadcrumb":{"@id":"https://memoria-framework.dev/docs/overview/hermes/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://memoria-framework.dev/docs/overview/hermes/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://memoria-framework.dev/docs/overview/hermes/"]}]},{"@type":"BreadcrumbList","@id":"https://memoria-framework.dev/docs/overview/hermes/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://memoria-framework.dev/","url":"https://memoria-framework.dev/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://memoria-framework.dev/docs/","url":"https://memoria-framework.dev/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://memoria-framework.dev/docs/overview/","url":"https://memoria-framework.dev/docs/overview/","name":"Overview"}},{"@type":"ListItem","position":4,"item":{"@id":"https://memoria-framework.dev/docs/overview/hermes/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://memoria-framework.dev/#/schema/article/1","headline":"Hermes","description":"","isPartOf":{"@id":"https://memoria-framework.dev/docs/overview/hermes/"},"mainEntityOfPage":{"@id":"https://memoria-framework.dev/docs/overview/hermes/"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","author":{"@id":"https://memoria-framework.dev/#/schema/person/2"},"publisher":{"@id":"https://memoria-framework.dev/#/schema/person/1"},"image":{"@id":"https://memoria-framework.dev/docs/overview/hermes/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://memoria-framework.dev/#/schema/person/2","name":"Victor Smirnov","sameAs":[]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://memoria-framework.dev/docs/overview/hermes/#/schema/image/2","url":null,"contentUrl":null,"caption":"Hermes"}]}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://memoria-framework.dev/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://memoria-framework.dev/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://memoria-framework.dev/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://memoria-framework.dev/site.webmanifest></head><body class="docs single"><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=/ aria-label=Memoria>Memoria</a>
<button class="btn btn-menu d-block d-md-none order-5" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-start border-0 py-md-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-md-none"></div><div class="offcanvas-header d-md-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>Memoria</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body px-4"><h3 class="h6 text-uppercase mb-3 d-md-none">Main</h3><ul class="nav flex-column flex-md-row ms-md-n3"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=/docs/overview/introduction/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/subprojects/overview/>Subprojects</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/victor-smirnov/memoria/issues>Issues</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/victor-smirnov/memoria/discussions>Discussions</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/victor-smirnov/memoria/wiki>Releases</a></li></ul><hr class="text-black-50 my-4 d-md-none"><h3 class="h6 text-uppercase mb-3 d-md-none">Socials</h3><ul class="nav flex-column flex-md-row ms-md-auto me-md-n5 pe-md-2"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/victor-smirnov/memoria><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li></ul></div></div></nav></header><nav class="doks-subnavbar py-2 sticky-lg-top" aria-label="Secondary navigation"><div class="container-xxl d-flex align-items-md-center"><form class="doks-search position-relative flex-grow-1 me-auto"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><button class="btn doks-sidebar-toggle d-lg-none ms-3 order-3 collapsed" type=button data-bs-toggle=collapse data-bs-target=#doks-docs-nav aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle documentation navigation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></button></div></nav><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-overview aria-expanded=true>
Overview</button><div class="collapse show" id=section-overview><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/overview/introduction/>Introduction to Memoria</a></li><li><a class="docs-link rounded" href=/docs/overview/philosophy/>Philosophy</a></li><li><a class="docs-link rounded active" href=/docs/overview/hermes/>Hermes</a></li><li><a class="docs-link rounded" href=/docs/overview/hrpc/>HRPC: Hermes RPC Protocol</a></li><li><a class="docs-link rounded" href=/docs/overview/containers/>Containers</a></li><li><a class="docs-link rounded" href=/docs/overview/storage/>Storage Engines</a></li><li><a class="docs-link rounded" href=/docs/overview/runtime/>Runtime Environments</a></li><li><a class="docs-link rounded" href=/docs/overview/vm/>DSL Engine</a></li><li><a class="docs-link rounded" href=/docs/overview/accel/>Memoria Acceleration Architecture (MAA)</a></li><li><a class="docs-link rounded" href=/docs/overview/mbt/>Memoria Build Tool</a></li><li><a class="docs-link rounded" href=/docs/overview/qt_creator_instructions/>Qt Creator Instructions</a></li><li><a class="docs-link rounded" href=/docs/overview/roadmap/>Project Roadmap</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-datazoo aria-expanded=false>
Data Zoo</button><div class=collapse id=section-datazoo><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/data-zoo/overview/>Core Data Structures -- Overview</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/partial-sum-tree/>Partial Sums Tree</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/searchable-seq/>Searchable Sequence</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/compressed-symbol-seq/>Compressed Symbol Sequence</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/hierarchical-containers/>Hierarchical Containers</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/louds-tree/>Level Order Unary Degree Sequence (LOUDS)</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/wavelet-tree/>Multiary Wavelet Trees</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/packed-allocator/>Packed Allocator</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/associative-memory-1/>Associative Memory (Part 1)</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/associative-memory-2/>Associative Memory (Part 2)</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apps aria-expanded=false>
Applications</button><div class=collapse id=section-apps><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/applications/aiml/>Hybrid AI</a></li><li><a class="docs-link rounded" href=/docs/applications/storage/>Computational Storage</a></li><li><a class="docs-link rounded" href=/docs/applications/db/>Converged Databases</a></li><li><a class="docs-link rounded" href=/docs/applications/co-design/>HW/SW Co-design</a></li><li><a class="docs-link rounded" href=/docs/applications/eiot/>Embedded and IoT Applications</a></li></ul></div></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-overview aria-expanded=true>
Overview</button><div class="collapse show" id=section-overview><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/overview/introduction/>Introduction to Memoria</a></li><li><a class="docs-link rounded" href=/docs/overview/philosophy/>Philosophy</a></li><li><a class="docs-link rounded active" href=/docs/overview/hermes/>Hermes</a></li><li><a class="docs-link rounded" href=/docs/overview/hrpc/>HRPC: Hermes RPC Protocol</a></li><li><a class="docs-link rounded" href=/docs/overview/containers/>Containers</a></li><li><a class="docs-link rounded" href=/docs/overview/storage/>Storage Engines</a></li><li><a class="docs-link rounded" href=/docs/overview/runtime/>Runtime Environments</a></li><li><a class="docs-link rounded" href=/docs/overview/vm/>DSL Engine</a></li><li><a class="docs-link rounded" href=/docs/overview/accel/>Memoria Acceleration Architecture (MAA)</a></li><li><a class="docs-link rounded" href=/docs/overview/mbt/>Memoria Build Tool</a></li><li><a class="docs-link rounded" href=/docs/overview/qt_creator_instructions/>Qt Creator Instructions</a></li><li><a class="docs-link rounded" href=/docs/overview/roadmap/>Project Roadmap</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-datazoo aria-expanded=false>
Data Zoo</button><div class=collapse id=section-datazoo><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/data-zoo/overview/>Core Data Structures -- Overview</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/partial-sum-tree/>Partial Sums Tree</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/searchable-seq/>Searchable Sequence</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/compressed-symbol-seq/>Compressed Symbol Sequence</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/hierarchical-containers/>Hierarchical Containers</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/louds-tree/>Level Order Unary Degree Sequence (LOUDS)</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/wavelet-tree/>Multiary Wavelet Trees</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/packed-allocator/>Packed Allocator</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/associative-memory-1/>Associative Memory (Part 1)</a></li><li><a class="docs-link rounded" href=/docs/data-zoo/associative-memory-2/>Associative Memory (Part 2)</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apps aria-expanded=false>
Applications</button><div class=collapse id=section-apps><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/applications/aiml/>Hybrid AI</a></li><li><a class="docs-link rounded" href=/docs/applications/storage/>Computational Storage</a></li><li><a class="docs-link rounded" href=/docs/applications/db/>Converged Databases</a></li><li><a class="docs-link rounded" href=/docs/applications/co-design/>HW/SW Co-design</a></li><li><a class="docs-link rounded" href=/docs/applications/eiot/>Embedded and IoT Applications</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#basic-information>Basic information</a></li><li><a href=#immutability>Immutability</a></li><li><a href=#hermes-object>Hermes Object</a><ul><li><a href=#56-bit-types>56-bit types</a></li></ul></li><li><a href=#datatypes>Datatypes</a></li><li><a href=#document>Document</a><ul><li><a href=#null-object>Null object</a></li><li><a href=#generic-object-array>Generic object array</a></li><li><a href=#typed-integer-array>Typed integer array</a></li><li><a href=#generic-map-between-strings-and-objects>Generic map between strings and objects</a></li><li><a href=#tinyobjectmap>TinyObjectMap</a></li></ul></li><li><a href=#semantic-graph>Semantic Graph</a></li><li><a href=#hermespath>HermesPath</a></li><li><a href=#templating-engine>Templating engine</a></li><li><a href=#schema>Schema</a></li><li><a href=#profiles>Profiles</a></li><li><a href=#hardware-implementation>Hardware implementation</a></li><li><a href=#interoperability-with-other-languages>Interoperability with other languages</a></li><li><a href=#sources>Sources</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Hermes</h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#basic-information>Basic information</a></li><li><a href=#immutability>Immutability</a></li><li><a href=#hermes-object>Hermes Object</a><ul><li><a href=#56-bit-types>56-bit types</a></li></ul></li><li><a href=#datatypes>Datatypes</a></li><li><a href=#document>Document</a><ul><li><a href=#null-object>Null object</a></li><li><a href=#generic-object-array>Generic object array</a></li><li><a href=#typed-integer-array>Typed integer array</a></li><li><a href=#generic-map-between-strings-and-objects>Generic map between strings and objects</a></li><li><a href=#tinyobjectmap>TinyObjectMap</a></li></ul></li><li><a href=#semantic-graph>Semantic Graph</a></li><li><a href=#hermespath>HermesPath</a></li><li><a href=#templating-engine>Templating engine</a></li><li><a href=#schema>Schema</a></li><li><a href=#profiles>Profiles</a></li><li><a href=#hardware-implementation>Hardware implementation</a></li><li><a href=#interoperability-with-other-languages>Interoperability with other languages</a></li><li><a href=#sources>Sources</a></li></ul></nav></div></nav><blockquote><p>In ancient Greek mythology Hermes is a messenger between gods and humans.</p></blockquote><h2 id=basic-information>Basic information<a href=#basic-information class=anchor aria-hidden=true>#</a></h2><p>In the context of Memoria Framework, Hermes is a solution to the &ldquo;last mile&rdquo; data modelling problem. <a href=/docs/overview/containers/>Containers</a> can be used to model large amounts of <em>highly structured</em> data. Hermes is intended to represent relatively small amount of <em>unstructured or semi-structured data</em> and can be used together with containers. Notable feature of Hermes as a data format is that all objects and data types have canonical <em>textual representation</em>, so Hermes data can be consumed and produced by humans. Hence, the name of the data format.</p><p>Hermes defines an arbitrarily structured <em>object graph</em> that is allocated in a continuous memory segment (or a series of fixed size segments) working as an <em>arena</em>. Top-level object is a <em>document</em>. Document is a container for Hermes <em>objects</em>. Hermes objects internally use <em>relative pointers</em>, so the data is <em>relocatable</em>. Hermes objects in this form can be:</p><ul><li>stored in Memoria containers,</li><li>memory-mapped from files or between processes,</li><li>embedded into an executable as a form of a <em>resource</em>,</li><li>sent over a network or shared between host CPU and <em>hardware accelerators</em>, even if the latter have a separate <em>address space</em>.</li></ul><p>Hermes documents can be of arbitrary memory size, the format internally has 64-bit pointers (even on 32-bit architectures). It&rsquo;s fine to have TB-size documents, but the format is not intended for that. Hermes documents are <em>garbage-collected</em> with a simple <em>copying GC</em> algorithm. So the larger documents are, the more time will be spent in compactifications. Ideally, Hermes documents <em>should</em> (but not required to) fit into a single storage block, that is typically 4-8KB and may be up to 1MB in Memoria. In this case, accessing Hermes objects stored in containers will be in a <em>zero-copy</em> way.</p><p>There are three serialization formats for Hermes data.</p><ol><li><strong>Zero</strong> serialization. Hermes data segment use relative addresses and can be externalized as is, as a raw memory block. All Hermes documents support fast <em>integrity checking</em> procedure to make sure that reading foreign segments is safe. This is the fastest format but not particularly the densest one. This format is mainly for <em>data storage</em>.</li><li><strong>Text</strong> serialization. Human-readable, safe, and the slowest (but still fast in raw numbers).</li><li><strong>Binary</strong> serialization. The densest option, but faster than the textual one. Safe. Best for networking when human-readability is not a requirement.</li></ol><h2 id=immutability>Immutability<a href=#immutability class=anchor aria-hidden=true>#</a></h2><p>Hermes documents are <em>mutable</em> and support run-time immutability enforcement (&ldquo;make it immutable&rdquo;). Immutable documents may be safely shared between threads with minor restrictions.</p><h2 id=hermes-object>Hermes Object<a href=#hermes-object class=anchor aria-hidden=true>#</a></h2><p>Hermes memory is <em>tagged</em>. A tag is a type label and has various length, from 1 to 32 bytes. Most commonly used types, like <code>Int</code> have tag length of 1 byte. Rarely used types may have tags up 32 bytes, in that case it&rsquo;s most likely a SHA256 <em>hash code</em> of the <em>type&rsquo;s declaration</em>. Hermes assumes that type hash collisions will be an extremely rare event.</p><p>Memory for tag is allocated address-wise <em>before</em> the object. Objects may have gaps between them in memory caused by alignment requirements. In that case, if a tag fits into this gap, it&rsquo;s allocated there. With high probability, short tags (for commonly used objects) do not take extra memory.</p><p>Objects tags <em>may be</em> used for memory integrity checking, but this is left to implementations. To support integrity checking, every object pointer may contain 8- or 16-bit hash of the corresponding tag. Such type of integrity protection is probabilistic, not deterministic. Note that at this moment (2024) integrity checking <em>is not yet supported</em>.</p><p>From the API&rsquo;s perspective, Hermes objects consist from two part. The first part is a private C++ object with verbose API conforming to certain rules. The second part is a public <code>View</code> for this object, this is much like <code>std::string_view</code> for string-like data. Mutable Hermes object receive a reference to the corresponding Document&rsquo;s arena allocator to allocate new data in. View object encapsulates all these complexities.</p><p>Views are <em>owning</em> in Hermes. Object&rsquo;s view holds a reference to the corresponding Document (for memory allocation) with a fast, <em>non-atomic</em>, reference counter. Hermes Views are nearly zero-cost, but not thread-safe.</p><p>Documents as containers have additional levels of reference counting indirection, including atomic counters. Sharing document&rsquo;s <em>data</em> between threads may be permitted in some cases.</p><h3 id=56-bit-types>56-bit types<a href=#56-bit-types class=anchor aria-hidden=true>#</a></h3><p>1-byte tag size has special consequences in Hermes: together with 64-bit integers, we are using <em>56-bit</em> integers and identifiers to be able to fit the entire value into a 64-bit memory slot of a pointer. That, in many cases, saves memory.</p><h2 id=datatypes>Datatypes<a href=#datatypes class=anchor aria-hidden=true>#</a></h2><p>Hermes has explicit notion of a type, and Hermes types are pretty close in semantics to C++ classes, they may be <em>parametric</em> in two ways. The first way is common with C++: <code>MyType&lt;Parameter></code> creates new instance of <code>MyType</code> parametrized by <code>Parameter</code>. The second type of parametrization is trickier. Hermes type may have an associated <em>state</em> that is considered as a shared state for all Hermes objects of this type. Type <code>Decimal(10,2)</code> have two <em>type constructor</em> <code>(10, 2)</code> parameters: precision 10 and scale 2. Type constructor in Hermes does not create a new type, so there is no way to <em>statically</em> specialize some code for <code>Decimal(10, 2)</code>. Object instances of type <code>Decimal</code> will have a pointer to a memory, storing the corresponding type constructor&rsquo;s data.</p><p>Generic types in Hermes are monomorphic.</p><p>To distinguish between C++ types and Hermes types that may have type constructors, the letter are called <em>Datatypes</em>.</p><p>Datatypes are first-class objects in Hermes and the rest of Memoria. So, we may have collections of datatypes, we cap process them as data and so on. We can also parse RTTI declaration of some C++ types as <em>normalized</em> datatypes and compute their corresponding 32-byte <em>type hash</em>. (Note that this feature is currently may be compiler-specific).</p><h2 id=document>Document<a href=#document class=anchor aria-hidden=true>#</a></h2><p>In Hermes &lsquo;document&rsquo; has two meanings.</p><p>First, <code>Document</code> is a container for Hermes data. Second, &lsquo;document&rsquo; is a specific set of predefined collections organizing objects into a tree-like structure, similar to Json. Below there is a short walk-through Hermes document text-serialization features giving us json-like experience.</p><h3 id=null-object>Null object<a href=#null-object class=anchor aria-hidden=true>#</a></h3><p>This is the simplest document that has no object.</p><pre><code class=language-json>null
</code></pre><h3 id=generic-object-array>Generic object array<a href=#generic-object-array class=anchor aria-hidden=true>#</a></h3><p>Generic array of Objects containing intgers:</p><pre><code class=language-json>[1, 2, 3, 4]
</code></pre><p>The same generic array of Objects containing numbers of different types (integer, unsigned integer, short and float):</p><pre><code class=language-json>[1, 2u, 3s, 4.567f]
</code></pre><h3 id=typed-integer-array>Typed integer array<a href=#typed-integer-array class=anchor aria-hidden=true>#</a></h3><p>The same array but of datatype <code>Array&lt;Int></code> using optimized memory layout:</p><pre><code class=language-json>@Array&lt;Int&gt; = [1, 2, 3, 4]
</code></pre><p>Important note that notation above does not mean that collection <code>[]</code> will have the type specified before it. It means that we create a typed collection <em>from</em> a generic one. Parser may optimize this process by not creating the latter and supplying the data directly to the former.</p><p>The point is that there may be may ways to create a Hermes object at parse time from Hermes data. For example, notation like <code>"string value"@SomeDataType</code> is a syntactic shortcut meaning that <code>"string value"</code> will be <em>converted</em> to Hermes object of datatype <code>SomeDataType</code> at the <em>parse time</em>:</p><pre><code class=language-json>&quot;19345068945625345634563564094564563458.609&quot;@Decimal(50,3)
</code></pre><p>Technically, string representation of Hermes data is not a static format, like Json, but a <em>domain specific language</em>. The purpose of this DSL is to make crafting complex Hermes data in a text form easier for humans.</p><h3 id=generic-map-between-strings-and-objects>Generic map between strings and objects<a href=#generic-map-between-strings-and-objects class=anchor aria-hidden=true>#</a></h3><p>Generic map between strings and objects:</p><pre><code class=language-json>{
  &quot;key1&quot;: 1, 
  &quot;key2&quot;: [1, 2, true],
  &quot;key3&quot;: @Array&lt;Int&gt; = [5,6,7,8]
}
</code></pre><h3 id=tinyobjectmap>TinyObjectMap<a href=#tinyobjectmap class=anchor aria-hidden=true>#</a></h3><p>There is a special memory-efficient variant of typed map, mapping from small integer in range [0, 51] to an Object. This map is very memory efficient, using only 16 bytes overhead per collection. It&rsquo;s also very fast for reading, because it uses just one <code>PopCnt()</code> instruction (usually 1 cycle on modern CPUs) to find the slot in the hash array, given the key. Values up to 56 bits (small strings, short integers, floats) may be embedded into the hash array. Hash array has no empty slots.</p><p>Given its runtime versatility, this type of a map is used extensively to represent C-like <em>dynamic</em> structures in Hermes, without creating a corresponding C++ objects. DSLs over Hermes may combine this type of map with <em>code</em>, resulting in dynamically typed <em>objects</em>.</p><h2 id=semantic-graph>Semantic Graph<a href=#semantic-graph class=anchor aria-hidden=true>#</a></h2><p>Semantic graph (SG) in Hermes adopts <a href=https://www.w3.org/RDF/>RDF</a>-<em>like</em> data representation to Hermes' object model. SG usually is a <em>binary relation</em> over <em>facts</em> in some <em>domain</em>, plus some model of formal semantics reducible to binary relations. Note that Knowledge Graph (KG) is basically the same thing, but has more features to capture and represent real-life knowledge.</p><p>SG have appealing theoretical and practical properties, but using them &ldquo;at scale&rdquo; (for large data sets) is a major technological challenge. Graphs or any form do not map well to memory hierarchies (a lot of random access), so it&rsquo;s a <em>very expensive</em> data representation and format.</p><p>Being multi-model, Memoria will be supporting various forms of graphs and binary relations anyway, so first-class support for SG starting from Hermes seems a consistent decision.</p><h2 id=hermespath>HermesPath<a href=#hermespath class=anchor aria-hidden=true>#</a></h2><p>Hermes has minimalist but expressive query language for its document subset, modelled after <a href=https://jmespath.org>JMESPath</a>.</p><h2 id=templating-engine>Templating engine<a href=#templating-engine class=anchor aria-hidden=true>#</a></h2><p>Templating (generating text) is possible with <a href=https://jinja.palletsprojects.com/en/3.1.x/>Jinja</a>-like templating language, integrated with HermesPath as expression language.</p><h2 id=schema>Schema<a href=#schema class=anchor aria-hidden=true>#</a></h2><p>Hermes has schema processor to enforce declarative and imperative constraints on Hermes documents, semantic graphs and other types of structures. Schema processor is a major component of Hermes' stack, that may work in an interactive mode, like a <em>language server</em> for Hermes data structures.</p><h2 id=profiles>Profiles<a href=#profiles class=anchor aria-hidden=true>#</a></h2><p>Hermes may support different <em>profiles</em>. A <em>profile</em> is a set of features Hermes container is supporting. Supporting all the features and data-types may be unnecessary and resource-consuming, especially on web and embedded platforms. For example, typical web applications don&rsquo;t need much more than JSON is providing out of the box (generic object, array, null and a few data types).</p><ul><li><p>Minimalist <em>&lsquo;pico&rsquo;</em> profile may support only generic <em>fixed size</em> array container, fixed sizevariant of <a href=#tinyobjectmap>TinyObjectMap</a>, 56- and 64-bit integers and strings. This profile will be the most compact one, yet functionality is sufficient for all basic interactions between code and devices.</p></li><li><p><em>&lsquo;Nano&rsquo;</em> profile may add generic fixed-size container mapping from Int56 to Object, that is sufficient for most of relational-type data (also, trees and graphs).</p></li><li><p><em>&lsquo;Micro&rsquo;</em> profile may add support of all integer (8, 16, 32 bit, including vlen), floating point types and sematic graph data-types.</p></li><li><p><em>&lsquo;Basic&rsquo;</em> profile may add essential dynamic (growable/shrinkable) containers that may be uses as a <em>working memory</em> by applications.</p></li><li><p>&mldr;</p></li></ul><p>And so on&mldr; Profiles are not necessary hierarchical and inclusive. Hermes has open type system, and supporting all possible types is just infeasible. So may be application-specific profiles, staying completely aside from the main profile set.</p><h2 id=hardware-implementation>Hardware implementation<a href=#hardware-implementation class=anchor aria-hidden=true>#</a></h2><p>Implementing parts of Hermes protocol directly in hardware makes sense in two cases: embedded and multicore accelerators, because in both cases CPU cores are pretty simple (not OoOE) and we don&rsquo;t want to waste CPU cycles on complex data encodings. So, there are basic areas where we can do it:</p><ol><li><strong>Tag dispatching</strong>. Mathematical operations on generic numbers go through either tag-indexed switch statement or hash table over multiple handlers. Implementing this dispatching directly in hardware may save a lot of cycles.</li><li><strong>Variable length integers</strong> may save a lot of memory and are actively used in Hermes. Supporting them directly in hardware will improve performance significantly.</li><li><strong><a href=/docs/data-zoo/searchable-seq/>Advanced Data Structures</a></strong>. Certain frequently used containers containers, like <a href=#tinyobjectmap>TinyObjectMap</a>, may rely on on advanced bit-parallel operations like rank/select (PopCnt and SelectN), implementing them in hardware will improve performance significantly (10-60x) over baseline.</li><li><strong>Immutability enforcement</strong>. If hardware supports memory segmentation, blocks containing finalized Hermes documents may be marked immutable.</li></ol><p>Besides these simple cases, important operations like binary serialization and deserialization, as well as consistency checking (reference tags and object memory layout checking) may be partially implemented in hardware, improving performance in many important cases.</p><p>Profile system may also be aligned with hardware acceleration. Profile may mean that certain datatypes are hardware-accelerated and using them is encouraged (other other possible datatypes).</p><h2 id=interoperability-with-other-languages>Interoperability with other languages<a href=#interoperability-with-other-languages class=anchor aria-hidden=true>#</a></h2><p>Hermes is a <em>C++-centric data model</em>, it relies heavily on RAII for memory management. Replicating it fully in other runtime environments may be difficult if even possible. To implement it fully, target runtime environment must support either RAII or at least ARC. D, Rust, Swift and CPython are in the green zone. For other environments like JavaScript, Java and Julia some functionality may be limited.</p><p>Another important dependency is that Hermes' datatypes may be pretty complex, like arbitrary precision numbers or safe integers with deterministic overflow semantics. Also, DSLs (HermesPath) may rely on extensive libraries of functions. Re-implementing it all in target language will lead to a lot of complex code duplication. So, bindings to Hermes will be relying on FFI to C++. The caveat is that binary code for full set of Hermes may be pretty large in size (10MB+) so running it in a browser (WASM) may be <em>impractical</em> (unless Hermes is supported natively).</p><h2 id=sources>Sources<a href=#sources class=anchor aria-hidden=true>#</a></h2><ol><li>Main <a href=https://github.com/victor-smirnov/memoria/tree/master/core/include/memoria/core/hermes>headers</a>.</li><li>Main <a href=https://github.com/victor-smirnov/memoria/tree/master/core/lib/hermes>sources</a></li></ol><div class="docs-navigation d-flex justify-content-between"><a href=/docs/overview/philosophy/><div class="card my-1"><div class="card-body py-2">&larr; Philosophy</div></div></a><a class=ms-auto href=/docs/overview/hrpc/><div class="card my-1"><div class="card-body py-2">HRPC: Hermes RPC Protocol &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://www.github.com/>Github</a>, <a href=https://gohugo.io/>Hugo</a>, and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/privacy-policy/>Privacy</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.73ca27033146a505b6a0f66b79d99f613a18e778bc9606fd223476d0ebf0fc10508b0d4f5c448b0a946fa1d71fbeffaae9732adc0c2890e61c449217fd6ee1c0.js integrity="sha512-c8onAzFGpQW2oPZredmfYToY53i8lgb9IjR20Ovw/BBQiw1PXESLCpRvodcfvv+q6XMq3AwokOYcRJIX/W7hwA==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.c5b6bb65307e087bfc3dd5a73cf000f3dc6a8b665db8c3fcbd62a3368e2f82ee494fd1ff5f025a09216cf6390bac7565c5469c6958caac1b9d09c85ba0adfefc.js integrity="sha512-xba7ZTB+CHv8PdWnPPAA89xqi2ZduMP8vWKjNo4vgu5JT9H/XwJaCSFs9jkLrHVlxUacaVjKrBudCchboK3+/A==" crossorigin=anonymous defer></script>
<script src=/js/vendor/katex/dist/katex.min.07c5862e6eea64c90e601fcaacaa0dbdb03f60dbbac68a5a5830130a00332df28001a5fa2375b739426606b441725db1af012c7e4b04b8fb222025cc0d2ac073.js integrity="sha512-B8WGLm7qZMkOYB/KrKoNvbA/YNu6xopaWDATCgAzLfKAAaX6I3W3OUJmBrRBcl2xrwEsfksEuPsiICXMDSrAcw==" crossorigin=anonymous defer></script>
<script src=/js/vendor/katex/dist/contrib/auto-render.min.bc779bab10cdc862f139e7cd6255a8f021bc483db2b7bc6d553238fb220e937dbe5cd511100d2ab764ee5d9f9092a2cdcc4e6ae109966efc18338f0b275d927d.js integrity="sha512-vHebqxDNyGLxOefNYlWo8CG8SD2yt7xtVTI4+yIOk32+XNUREA0qt2TuXZ+QkqLNzE5q4QmWbvwYM48LJ12SfQ==" crossorigin=anonymous defer></script>
<script src=/main.min.56cf146845ee56429c57a9bb74bee52540a1aa942a32506ad0d185db760f2f7a5d76f39cde824735c8b7e89f2e4453cc4da383eaa2c2a7d6a2c9dafd7061e74d.js integrity="sha512-Vs8UaEXuVkKcV6m7dL7lJUChqpQqMlBq0NGF23YPL3pddvOc3oJHNci36J8uRFPMTaOD6qLCp9aiydr9cGHnTQ==" crossorigin=anonymous defer></script>
<script src=https://memoria-framework.dev/index.min.1b21cb85e866f736d5c6c300094547d690538c96a034f6a8ec4c6634ca7a18aced3ab11293b31396ae66ee8ee64058425b46f4f5c9bf85f69de2cc4a35b4cdb2.js integrity="sha512-GyHLhehm9zbVxsMACUVH1pBTjJagNPao7ExmNMp6GKztOrESk7MTlq5m7o7mQFhCW0b09cm/hfad4sxKNbTNsg==" crossorigin=anonymous defer></script></body></html>