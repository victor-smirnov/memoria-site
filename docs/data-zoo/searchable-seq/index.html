<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://memoria-framework.dev/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://memoria-framework.dev/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://memoria-framework.dev/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://memoria-framework.dev/fonts/KaTeX_Main-Regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://memoria-framework.dev/fonts/KaTeX_Math-Italic.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://memoria-framework.dev/main.936beb930fd98ad42e9ffeb326821156010eee32296e56a34ddbc6be19fe80fa939278f5ca78e22e25b3e3a8808e25f8050913e6a9c92db586b3d82e09e3d179.css integrity="sha512-k2vrkw/ZitQun/6zJoIRVgEO7jIpblajTdvGvhn+gPqTknj1ynjiLiWz46iAjiX4BQkT5qnJLbWGs9guCePReQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Searchable Sequence - Memoria</title><meta name=description content="Searchable sequence or rank/select dictionary is a sequence of symbols that supports two operations:
rank(position, symbol) is number of occurrences of symbol in the sequence in the range [0, position) select(rank, symbol) is a position of rank-th occurrence of the symbol in the sequence. Usually the alphabet is {0, 1} because of its practical importance, but larger alphabets are of significant interest too. Especially in Bioinformatics and Artificial Intelligence.
There are many implementations of binary searchable sequences (bitmaps) providing fast query operations with $O(1)$ time complexity."><link rel=canonical href=https://memoria-framework.dev/docs/data-zoo/searchable-seq/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Searchable Sequence"><meta property="og:description" content="Searchable sequence or rank/select dictionary is a sequence of symbols that supports two operations:
rank(position, symbol) is number of occurrences of symbol in the sequence in the range [0, position) select(rank, symbol) is a position of rank-th occurrence of the symbol in the sequence. Usually the alphabet is {0, 1} because of its practical importance, but larger alphabets are of significant interest too. Especially in Bioinformatics and Artificial Intelligence.
There are many implementations of binary searchable sequences (bitmaps) providing fast query operations with $O(1)$ time complexity."><meta property="og:url" content="https://memoria-framework.dev/docs/data-zoo/searchable-seq/"><meta property="og:site_name" content="Memoria"><meta property="article:published_time" content="2021-10-28T02:07:01-04:00"><meta property="article:modified_time" content="2021-10-28T02:07:01-04:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:title content="Searchable Sequence"><meta name=twitter:description content><meta name=twitter:card content="summary"><meta name=twitter:image:alt content="Searchable Sequence"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://memoria-framework.dev/#/schema/person/1","name":"Memoria","url":"https://memoria-framework.dev/","sameAs":[],"image":{"@type":"ImageObject","@id":"https://memoria-framework.dev/#/schema/image/1","url":"https://memoria-framework.dev/\u003cnil\u003e","width":null,"height":null,"caption":"Memoria"}},{"@type":"WebSite","@id":"https://memoria-framework.dev/#/schema/website/1","url":"https://memoria-framework.dev/","name":"Memoria","description":"","publisher":{"@id":"https://memoria-framework.dev/#/schema/person/1"}},{"@type":"WebPage","@id":"https://memoria-framework.dev/docs/data-zoo/searchable-seq/","url":"https://memoria-framework.dev/docs/data-zoo/searchable-seq/","name":"Searchable Sequence","description":"","isPartOf":{"@id":"https://memoria-framework.dev/#/schema/website/1"},"about":{"@id":"https://memoria-framework.dev/#/schema/person/1"},"datePublished":"2021-10-28T02:07:01CET","dateModified":"2021-10-28T02:07:01CET","breadcrumb":{"@id":"https://memoria-framework.dev/docs/data-zoo/searchable-seq/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://memoria-framework.dev/docs/data-zoo/searchable-seq/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://memoria-framework.dev/docs/data-zoo/searchable-seq/"]}]},{"@type":"BreadcrumbList","@id":"https://memoria-framework.dev/docs/data-zoo/searchable-seq/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://memoria-framework.dev/","url":"https://memoria-framework.dev/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://memoria-framework.dev/docs/","url":"https://memoria-framework.dev/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://memoria-framework.dev/docs/data-zoo/","url":"https://memoria-framework.dev/docs/data-zoo/","name":"Data Zoo"}},{"@type":"ListItem","position":4,"item":{"@id":"https://memoria-framework.dev/docs/data-zoo/searchable-seq/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://memoria-framework.dev/#/schema/article/1","headline":"Searchable Sequence","description":"","isPartOf":{"@id":"https://memoria-framework.dev/docs/data-zoo/searchable-seq/"},"mainEntityOfPage":{"@id":"https://memoria-framework.dev/docs/data-zoo/searchable-seq/"},"datePublished":"2021-10-28T02:07:01CET","dateModified":"2021-10-28T02:07:01CET","author":{"@id":"https://memoria-framework.dev/#/schema/person/2"},"publisher":{"@id":"https://memoria-framework.dev/#/schema/person/1"},"image":{"@id":"https://memoria-framework.dev/docs/data-zoo/searchable-seq/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://memoria-framework.dev/#/schema/person/2","name":"Victor Smirnov","sameAs":[]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://memoria-framework.dev/docs/data-zoo/searchable-seq/#/schema/image/2","url":null,"contentUrl":null,"caption":"Searchable Sequence"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://memoria-framework.dev/favicon.ico sizes=any><link rel=apple-touch-icon sizes=180x180 href=https://memoria-framework.dev/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://memoria-framework.dev/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://memoria-framework.dev/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://memoria-framework.dev/site.webmanifest></head><body class="docs single"><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=/ aria-label=Memoria>Memoria</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>Memoria</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=/docs/overview/introduction/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/tutorial/quick-start>Tutorial</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/api/overview/>API</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/python/overview/>Python</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/subprojects/overview/>Subprojects</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/victor-smirnov/memoria/issues>Issues</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/victor-smirnov/memoria/discussions>Discussions</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/victor-smirnov/memoria/wiki>Releases</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder aria-label autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/victor-smirnov/memoria><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul></div></div></nav></header><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2">Overview</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/overview/introduction/>Introduction to Memoria</a></li><li><a class=docs-link href=/docs/overview/definitions/>Basic Definitions</a></li><li><a class=docs-link href=/docs/overview/whyc++/>Why C++</a></li><li><a class=docs-link href=/docs/overview/hardware-accel/>Hardware Acceleration in Memoria</a></li><li><a class=docs-link href=/docs/overview/qt_creator_instructions/>QT Creator Instructions</a></li><li><a class=docs-link href=/docs/overview/faq/>FAQ</a></li></ul><h3 class="h6 text-uppercase mb-2">Data Zoo</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/data-zoo/overview/>Core Data Structures -- Overview</a></li><li><a class=docs-link href=/docs/data-zoo/partial-sum-tree/>Partial Sums Tree</a></li><li><a class="docs-link active" href=/docs/data-zoo/searchable-seq/>Searchable Sequence</a></li><li><a class=docs-link href=/docs/data-zoo/compressed-symbol-seq/>Compressed Symbol Sequence</a></li><li><a class=docs-link href=/docs/data-zoo/hierarchical-table/>Hierarchical Table</a></li><li><a class=docs-link href=/docs/data-zoo/louds-tree/>Level Order Unary Degree Sequence (LOUDS)</a></li><li><a class=docs-link href=/docs/data-zoo/wavelet-tree/>Multiary Wavelet Trees</a></li><li><a class=docs-link href=/docs/data-zoo/mutistream-tree/>Mutistream Balanced Tree</a></li><li><a class=docs-link href=/docs/data-zoo/packed-allocator/>Packed Allocator</a></li><li><a class=docs-link href=/docs/data-zoo/associative-memory-1/>Associative Memory (Part 1)</a></li><li><a class=docs-link href=/docs/data-zoo/associative-memory-2/>Associative Memory (Part 2)</a></li></ul><h3 class="h6 text-uppercase mb-2">Storage Engines</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/storage/overview/>Storage Engines Overview</a></li><li><a class=docs-link href=/docs/storage/memory-store/>Memory Store</a></li><li><a class=docs-link href=/docs/storage/swmr-store/>SWMR Store</a></li><li><a class=docs-link href=/docs/storage/overlay-store/>Overlay Store</a></li></ul><h3 class="h6 text-uppercase mb-2">Runtime Environment</h3><h3 class="h6 text-uppercase mb-2">Linked Data & SDN</h3><h3 class="h6 text-uppercase mb-2">Digital Philosophy</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/d-phil/intro/>Philosophy of Memoria - Intro</a></li><li><a class=docs-link href=/docs/d-phil/ai/>Memoria and Artificial Intelligence</a></li></ul><h3 class="h6 text-uppercase mb-2">Memoria Build Tool</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/mbt/overview/>MBT Overview</a></li></ul><h3 class="h6 text-uppercase mb-2">Testing Framework</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/tests/overview/>Tests -- Overview</a></li></ul><h3 class="h6 text-uppercase mb-2">Datascope</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/datascope/overview/>Datascope Overview</a></li></ul><h3 class="h6 text-uppercase mb-2">Misc</h3></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar docs-sidebar-top d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><h3 class="h6 text-uppercase mb-2">Overview</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/overview/introduction/>Introduction to Memoria</a></li><li><a class=docs-link href=/docs/overview/definitions/>Basic Definitions</a></li><li><a class=docs-link href=/docs/overview/whyc++/>Why C++</a></li><li><a class=docs-link href=/docs/overview/hardware-accel/>Hardware Acceleration in Memoria</a></li><li><a class=docs-link href=/docs/overview/qt_creator_instructions/>QT Creator Instructions</a></li><li><a class=docs-link href=/docs/overview/faq/>FAQ</a></li></ul><h3 class="h6 text-uppercase mb-2">Data Zoo</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/data-zoo/overview/>Core Data Structures -- Overview</a></li><li><a class=docs-link href=/docs/data-zoo/partial-sum-tree/>Partial Sums Tree</a></li><li><a class="docs-link active" href=/docs/data-zoo/searchable-seq/>Searchable Sequence</a></li><li><a class=docs-link href=/docs/data-zoo/compressed-symbol-seq/>Compressed Symbol Sequence</a></li><li><a class=docs-link href=/docs/data-zoo/hierarchical-table/>Hierarchical Table</a></li><li><a class=docs-link href=/docs/data-zoo/louds-tree/>Level Order Unary Degree Sequence (LOUDS)</a></li><li><a class=docs-link href=/docs/data-zoo/wavelet-tree/>Multiary Wavelet Trees</a></li><li><a class=docs-link href=/docs/data-zoo/mutistream-tree/>Mutistream Balanced Tree</a></li><li><a class=docs-link href=/docs/data-zoo/packed-allocator/>Packed Allocator</a></li><li><a class=docs-link href=/docs/data-zoo/associative-memory-1/>Associative Memory (Part 1)</a></li><li><a class=docs-link href=/docs/data-zoo/associative-memory-2/>Associative Memory (Part 2)</a></li></ul><h3 class="h6 text-uppercase mb-2">Storage Engines</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/storage/overview/>Storage Engines Overview</a></li><li><a class=docs-link href=/docs/storage/memory-store/>Memory Store</a></li><li><a class=docs-link href=/docs/storage/swmr-store/>SWMR Store</a></li><li><a class=docs-link href=/docs/storage/overlay-store/>Overlay Store</a></li></ul><h3 class="h6 text-uppercase mb-2">Runtime Environment</h3><h3 class="h6 text-uppercase mb-2">Linked Data & SDN</h3><h3 class="h6 text-uppercase mb-2">Digital Philosophy</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/d-phil/intro/>Philosophy of Memoria - Intro</a></li><li><a class=docs-link href=/docs/d-phil/ai/>Memoria and Artificial Intelligence</a></li></ul><h3 class="h6 text-uppercase mb-2">Memoria Build Tool</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/mbt/overview/>MBT Overview</a></li></ul><h3 class="h6 text-uppercase mb-2">Testing Framework</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/tests/overview/>Tests -- Overview</a></li></ul><h3 class="h6 text-uppercase mb-2">Datascope</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/datascope/overview/>Datascope Overview</a></li></ul><h3 class="h6 text-uppercase mb-2">Misc</h3></nav></div><nav class="docs-toc docs-toc-top d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#creation-and-access>Creation and Access</a></li><li><a href=#rank>Rank</a></li><li><a href=#select>Select</a></li><li><a href=#hardware-acceleration>Hardware Acceleration</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#creation-and-access>Creation and Access</a></li><li><a href=#rank>Rank</a></li><li><a href=#select>Select</a></li><li><a href=#hardware-acceleration>Hardware Acceleration</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl"><h1>Searchable Sequence</h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#creation-and-access>Creation and Access</a></li><li><a href=#rank>Rank</a></li><li><a href=#select>Select</a></li><li><a href=#hardware-acceleration>Hardware Acceleration</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#creation-and-access>Creation and Access</a></li><li><a href=#rank>Rank</a></li><li><a href=#select>Select</a></li><li><a href=#hardware-acceleration>Hardware Acceleration</a></li></ul></nav></div></nav><p>Searchable sequence or rank/select dictionary is a sequence of symbols that supports two operations:</p><ol><li><code>rank(position, symbol)</code> is number of occurrences of <code>symbol</code> in the sequence in the range [0, position)</li><li><code>select(rank, symbol)</code> is a position of <code>rank</code>-th occurrence of the <code>symbol</code> in the sequence.</li></ol><p>Usually the alphabet is {0, 1} because of its practical importance, but larger alphabets are of significant interest too. Especially in Bioinformatics and Artificial Intelligence.</p><p>There are many implementations of binary searchable sequences (bitmaps) providing fast query operations with $O(1)$ time complexity. Memoria uses partial sum indexes to speedup rank/select queries. They are asymptotically slower than other methods but have additional space overhead for the index.</p><p>Packed searchable sequence is a searchable sequences that has all its data structured packed into a single contiguous memory block with packed allocator. It consists from two data structures:</p><ol><li>multi-index partial sum tree to speedup rank/select queries;</li><li>array of sequence&rsquo;s symbols.</li></ol><p>See the following figure for the case of searchable bitmap.</p><figure><img src=packed_seq.svg></figure><p>Note that for a sequence with K-symbol alphabet, packed sum tree has K indexes, that results in significant overhead even for relatively small alphabets. For example 8-bit sequence has 256-index packed tree that takes more than 200% of raw data size if the tree is not compressed. To lower this overhead Memoria provides various compressed encodings for the index&rsquo;s values.</p><h2 id=creation-and-access>Creation and Access <a href=#creation-and-access class=anchor aria-hidden=true>#</a></h2><p>To create partial sum tree for a sequence we first need to split it logically into blocks of fixed number of symbols (16 at the figure). Then sum different symbols in the block, each such vector is a simple partial sum tree leaf. Build other levels of the tree accordingly.</p><ul><li>Symbol update is relatively fast, it takes $O(log(N))$ time.</li><li>Symbol insertion is $O(N)$, it requires full rebuilding of partial sum tree.</li><li>Symbol access does not require the tree to perform, it takes $O(1)$ time.</li></ul><h2 id=rank>Rank <a href=#rank class=anchor aria-hidden=true>#</a></h2><p>To compute <code>rank(position, symbol)</code></p><ol><li>Given <code>position</code>, determine sequence <code>block_number</code> for that position, and <code>block_pos</code> position in the block, $O(1)$;</li><li><code>block_rank</code> = <a href=/docs/data-zoo/partial-sum-tree>sum</a>(0, <code>block_number</code>) in the sum tree, $O(log(N))$;</li><li>count number of <code>symbol</code>s in the block to <code>block_pos</code>, $O(1)$;</li><li>final rank is (2) + (3).</li></ol><h2 id=select>Select <a href=#select class=anchor aria-hidden=true>#</a></h2><p>To compute <code>select(rank, symbol)</code></p><ol><li>Given partial sum tree and a <code>symbol</code>, determine target sequence <code>block_number</code> having <code>total_rank &lt;= rank</code> for the given <code>symbol</code> using <a href=/docs/data-zoo/partial-sum-tree>findLE</a> operation, $O(log(N))$;</li><li>For the given block, compute <code>rank_prefix</code> = <a href=/docs/data-zoo/partial-sum-tree>sum</a>(0, <code>block_number</code>) for the given <code>symbol</code>, $O(log(N))$;</li><li>Compute <code>local_rank = rank - rank_prefix</code>;</li><li>Scan the block and find position of <code>symbol</code> having rank in the block = <code>local_rank</code>, $O(1)$.</li></ol><p>Actual implementation joins operations (1) and (2) into a single traverse of the sum tree.</p><h2 id=hardware-acceleration>Hardware Acceleration <a href=#hardware-acceleration class=anchor aria-hidden=true>#</a></h2><p>Consideration are the same as for <a href=/docs/data-zoo/partial-sum-tree>partial/prefix sum trees</a>, especially, because searchable sequence contains partial sum tree as an indexing structure.</p><p>Modern CPUs usually have direct implementations for rank (PopCount) for binary alphabets. Select operation may also be partially supported. To accelerate searchable sequences, it&rsquo;s necessary to implement rang/select over arbitrary alphabets (1-8 bits per symbol).</p><p>Symbol blocks are also contiguous in memory and can be multiple of DRAM memory blocks. Rank/select machinery is simpler or comparable with machinery for addition and subtraction. Those operations can be efficiently implemented in a small silicon budget and at high frequency.</p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="docs-navigation d-flex justify-content-between"><a href=/docs/data-zoo/partial-sum-tree/><div class="card my-1"><div class="card-body py-2">&larr; Partial Sums Tree</div></div></a><a class=ms-auto href=/docs/data-zoo/compressed-symbol-seq/><div class="card my-1"><div class="card-body py-2">Compressed Symbol Sequence &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://www.github.com/>Github</a>, <a href=https://gohugo.io/>Hugo</a>, and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/privacy-policy/>Privacy</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.f06fe6dc0efc9ee1e806021a0c338278256ecf163b547e8e8769fe60b0a1c0d505782852616ca4e1ff6a719eb8fc954e1d26031b8ab3ca71fb9d9998081b319e.js integrity="sha512-8G/m3A78nuHoBgIaDDOCeCVuzxY7VH6Oh2n+YLChwNUFeChSYWyk4f9qcZ64/JVOHSYDG4qzynH7nZmYCBsxng==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.349dda7f776056c3f39bc8ccb2eeab63bafd33d052a7266441e0912a4ad60fe0932e116b570cf3b263f7b944035ea6076fb02ee3b541df9fa4a48327b3b2314a.js integrity="sha512-NJ3af3dgVsPzm8jMsu6rY7r9M9BSpyZkQeCRKkrWD+CTLhFrVwzzsmP3uUQDXqYHb7Au47VB35+kpIMns7IxSg==" crossorigin=anonymous defer></script>
<script src=/js/vendor/katex/dist/katex.min.8370e08d29f784ff7c9a902e9acd0e13dbcc29df754e3b6169e0243fddd6efb28a8c3f22d1f82cb26e83f1bb2bf9f5923c696f7dad0e219d8617071e5b45ee15.js integrity="sha512-g3DgjSn3hP98mpAums0OE9vMKd91TjthaeAkP93W77KKjD8i0fgssm6D8bsr+fWSPGlvfa0OIZ2GFwceW0XuFQ==" crossorigin=anonymous defer></script>
<script src=/js/vendor/katex/dist/contrib/auto-render.min.17afcd53ae964f755803834d912cea7b9c8581cd7ab706ddf37fc95ae96365dd6e45f2083d19b63ead2d842388f769d174b4866fff4ddefb85bcbb7a4bba8434.js integrity="sha512-F6/NU66WT3VYA4NNkSzqe5yFgc16twbd83/JWuljZd1uRfIIPRm2Pq0thCOI92nRdLSGb/9N3vuFvLt6S7qENA==" crossorigin=anonymous defer></script>
<script src=/main.min.f4fc9672b82291a008c0e098e13b1cf76efef8389cf4ecfacd957f72a374aac24f8fcd030f4982efbf7ba73dbc434fa95bfa2ae5f78d156d7c269f97c9ef020d.js integrity="sha512-9PyWcrgikaAIwOCY4Tsc927++Dic9Oz6zZV/cqN0qsJPj80DD0mC7797pz28Q0+pW/oq5feNFW18Jp+Xye8CDQ==" crossorigin=anonymous defer></script>
<script src=https://memoria-framework.dev/index.min.58fe3aacc82c707b37a3645ba51a94a2d1400a153b95e2890fb5dda3bb79df0176ae8074d0e017edec4767df990ece151ff81ca58a86e292846beff6d66b9162.js integrity="sha512-WP46rMgscHs3o2RbpRqUotFAChU7leKJD7Xdo7t53wF2roB00OAX7exHZ9+ZDs4VH/gcpYqG4pKEa+/21muRYg==" crossorigin=anonymous defer></script></body></html>